{"ts":1374562590388,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var Global={};\r\n    Global.nickname;\r\n    Global.autoscroll = true;    \r\n    \r\n    Global.soundToggle = true;\r\n    Global.timer_reconnect;\r\n    Global.socket;\r\n    \r\n    Global.nickNameSend = function(){\r\n        Global.socket.emit('nickname', Global.nickname);        \r\n    }\r\n    Global.nickNameSubmit = function(){\r\n        $('#nickName').val('');\r\n        $('#globalFooter').fadeIn(1000);\r\n        $('#nickNameSubmit').hide(1000);\r\n        $('#nickName').hide(1000);\r\n        $('#chatHeaderText').text('Вы вошли как '+Global.nickname);\r\n        $('#exitSubmit').show(1000);\r\n        $('#msgBox').focus();\r\n        Global.nickNameSend();        \r\n    }\r\n    Global.selfDisconnect = function(){\r\n        Global.socket.disconnect();\r\n        clearTimeout(Global.timer_reconnect);\r\n\t\tGlobal.timer_reconnect=false;\r\n        $('#status').text('Отключено').css({\r\n            'text-shadow':'0 0 5px #F00',\r\n            'color':'#F00'\r\n        });\r\n    }\r\n    Global.sendMsg = function(){\r\n        var msg = $('#msgBox').val();\r\n        $('#msgBox').val('');\r\n        Global.socket.emit('msg', msg);\r\n    }\r\n    Global.exitSubmit =function(){\r\n        Global.socket.emit('exit');\r\n        $('#chatHeaderText').text('Введите свой ник:');\r\n        $('#nickNameSubmit').show(1000);\r\n        $('#nickName').show(1000);\r\n        $('#exitSubmit').hide(1000);\r\n        $('#nickName').val('');\r\n        $('#globalFooter').fadeOut(1000);\r\n    }\r\n    Global.autoscrolling = function(){\r\n        if(Global.autoscroll){\r\n            var scroll = $('#chatBody')[0].scrollHeight;\r\n            $('#chatBody').animate({'scrollTop':scroll},1000);\r\n        }\r\n        else;\r\n    }"]],"start1":0,"start2":0,"length1":0,"length2":1658}]],"length":1658}
{"contributors":[],"silentsave":false,"ts":1374728771271,"patch":[[{"diffs":[[0,"e;    \r\n    "],[1,"Global.users = {};"],[0,"\r\n    Global"]],"start1":65,"start2":65,"length1":24,"length2":42},{"diffs":[[0,"eSend();"],[1,"\r\n    }\r\n    Global.userCheck = function(){//Проверка имеется ли такой никнейм\r\n        if(Global.users[Global.nickname]){//Если да, то просим ввести его пароль\r\n            alert('UserCheck = true');\r\n            Global.userAuth();\r\n        }\r\n        else{//если нет, спрашиваем создать ли его в системе\r\n            alert('UserCheck = false');\r\n            Global.userAsk();\r\n        }\r\n    }\r\n    Global.userAsk = function(){\r\n        $(document).ready(function(){\r\n            alert('UserAsk');\r\n            $('#userRegistration').show(1000);//показываем диалог\r\n            $('#userRegAsk').show(1000);//показываем вопрос\r\n            $('#userRegYes').click(function(){\r\n                $('#userPass').show(1000);//показываем поля пароля\r\n                $('#userRegAsk').hide(1000);//прячем кнопки\r\n            });\r\n            $('#userRegNo').click(function(){\r\n                $('#userRegistration').hide(1000);//закрываем диалог\r\n                Global.nickNameSubmit();//заходим за гостя с ником\r\n            });\r\n            $('#userRegSubmit').click(function() {\r\n                //Анализ полей пароля и отправка на сервер значения\r\n                alert('Нажата кнопка сохранить');\r\n                var newUserPass = $('#newUserPass').val();;\r\n                var newUserPassConfirm = $('#newUserPassConfirm').val();\r\n                alert('newUserPass:'+newUserPass+'newUserPassConfirm:'+newUserPassConfirm);\r\n                if(newUserPass && newUserPass == newUserPassConfirm){\r\n                    Global.userRegistration(newUserPass);\r\n                    $('#userRegistration').hide(1000);\r\n                    $('#userRegWarn').hide(100);\r\n                }\r\n                else{\r\n                    $('#userRegWarn').show(100);\r\n                }                \r\n            });\r\n            $('#userRegCancel').click(function() {//делаем тоже что и при отмене\r\n                $('#userRegistration').hide(1000);\r\n                Global.nickNameSubmit();\r\n            });\r\n        });\r\n    }\r\n    Global.userAuth = function(){\r\n        alert('UserAuth');\r\n        $('#userAuthorization').show(1000);\r\n        $('#userAuthAsk').show(1000);//показываем кнопки\r\n        $('#userAuthYes').click(function(){\r\n            $('#authUserPass').show(1000);//тут мы выводим поля пароля и анализ содержимого\r\n            $('#userAuthAsk').hide(1000);//прячем кнопки    \r\n            $('#userAuthSubmit').click(function() {//тут будет анализ пароля\r\n                if($('#oldUserPass').val()){\r\n                    var oldUserPass = $('#oldUserPass').val();\r\n                    Global.socket.emit('existUser', oldUserPass);\r\n                    $('#userAuthWarn').hide(100);\r\n                    $('#userAuthorization').hide(1000);\r\n                }\r\n                else{\r\n                    $('#userAuthWarn').show(100);\r\n                }\r\n            });\r\n            $('#userAuthCancel').click(function() {//ут закрытие диалога\r\n                $('#userAuthorization').hide(1000);//прячем диалог\r\n                $('#nickName').val('');\r\n                $('#nickName').focus();\r\n            });\r\n        });\r\n        $('#userAuthNo').click(function(){\r\n            $('#userAuthorization').hide(1000);//прячем диалог\r\n            $('#nickName').val('');\r\n            $('#nickName').focus();\r\n        });\r\n    }\r\n    Global.userRegistration = function(data){\r\n"],[0,"        "]],"start1":650,"start2":650,"length1":16,"length2":3395}]],"length":5055,"saved":false}
{"contributors":[],"silentsave":false,"ts":1374743835531,"patch":[[{"diffs":[[0,"n').hide(100);\r\n"],[1,"                    alert('Проверка прошла');\r\n"],[0,"                "]],"start1":2303,"start2":2303,"length1":32,"length2":79}]],"length":5102,"saved":false}
{"contributors":[],"silentsave":false,"ts":1374745484518,"patch":[[{"diffs":[[0,");\r\n"],[-1,"                alert('newUserPass:'+newUserPass+'newUserPassConfirm:'+newUserPassConfirm);\r\n"],[0,"    "]],"start1":1986,"start2":1986,"length1":101,"length2":8},{"diffs":[[0,"data){\r\n        "],[1,"Global.nickNameSubmit();\r\n        Global.socket.emit('registrationUser', data);"],[0,"\r\n    }\r\n    Glo"]],"start1":3983,"start2":3983,"length1":32,"length2":111}]],"length":5088,"saved":false}
{"contributors":[],"silentsave":false,"ts":1374751193350,"patch":[[{"diffs":[[0,"икнейм\r\n"],[1,"        alert('Проверка ника в массиве:'+Global.users[Global.nickname]);\r\n"],[0,"        "]],"start1":730,"start2":730,"length1":16,"length2":90},{"diffs":[[0,"bal."],[-1,"nickNameSubmit();\r\n        Global.socket.emit('registrationUser', "],[1,"socket.emit('registrationUser', {'nickname':Global.nickname, 'password':"],[0,"data"],[1,"}"],[0,");\r\n"]],"start1":4076,"start2":4076,"length1":78,"length2":85}]],"length":5169,"saved":false}
{"ts":1374751506474,"patch":[[{"diffs":[[0,"rue;"],[-1,"    \r\n    Global.users = {};"],[0,"\r\n  "]],"start1":63,"start2":63,"length1":36,"length2":8}]],"length":5141,"saved":false}
