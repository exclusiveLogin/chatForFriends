{"ts":1374219852944,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"{\"ts\":1374053367820,\"silentsave\":true,\"restoring\":false,\"patch\":[[{\"diffs\":[[1,\"// Client side Events\\r\\n$(document).ready(function() {\\r\\n    $('#msgSend').mousedown(function(){\\r\\n\\t\\t$(this).addClass('msgSendClick');\\r\\n\\t\\t});\\r\\n\\t$('#msgSend').mouseup(function(){\\r\\n\\t\\t$(this).removeClass('msgSendClick');\\r\\n\\t\\t});\\r\\n        \\r\\n    \\r\\n    \\r\\n    var socket = io.connect('http://chatforfriends.serenity.c9.io');\\r\\n    var nickname;\\r\\n    var autoscroll = true;\\r\\n    $('#autoscroll').addClass('autoscrollOn');\\r\\n    var msg_in = document.getElementById('msg_sound');\\r\\n    var msg_out = document.getElementById('msg_sound_out');\\r\\n    var soundToggle = true;\\r\\n    \\r\\n    socket.on('id', function(data){\\r\\n        var id = data.substring(0,10);\\r\\n        socket.emit('guestid',id);\\r\\n    });\\r\\n    \\r\\n    $('#status').text('Отключено').css({\\r\\n            'text-shadow':'0 0 5px #F00',\\r\\n            'color':'#F00'\\r\\n        });\\r\\n    \\r\\n    socket.on('connected', function(data){\\r\\n        $('#chat').fadeIn(1000);\\r\\n        $('#contactList').fadeIn(1000);\\r\\n        if(nickname){\\r\\n            $('#globalFooter').fadeIn(1000);\\r\\n            nickNameSend();\\r\\n        }\\r\\n        else;\\r\\n        \\r\\n        $('#status').text('Подключено').css({\\r\\n            'text-shadow':'0 0 5px #0F0',\\r\\n            'color':'#0F0'\\r\\n        });        \\r\\n    });\\r\\n    \\r\\n    socket.on('welcome', function(data){\\r\\n       var msg = '<div class=\\\"chatCellSys\\\">'+\\r\\n                '<div class=\\\"chatCellHeader\\\">Системное сообщение</div>'+\\r\\n                '<div class=\\\"chatCellBodySys\\\">'+data+\\r\\n                '</div></div>';  \\r\\n        $('#chatBody').append(msg);\\r\\n        autoscrolling();\\r\\n    });\\r\\n    \\r\\n    socket.on('send', function(data){\\r\\n        var msg;\\r\\n        if (data.nick == nickname) {\\r\\n            msg = '<div class=\\\"chatCellSelf\\\">'+\\r\\n                '<div class=\\\"chatCellHeader\\\">Вы пишете:</div>'+\\r\\n                '<div class=\\\"chatCellBodySelf\\\">'+data.msg+\\r\\n                '</div></div>'; \\r\\n                if (soundToggle) {\\r\\n                    msg_out.play();\\r\\n                }\\r\\n                else;                \\r\\n        }\\r\\n        else{\\r\\n            msg = '<div class=\\\"chatCell\\\">'+\\r\\n                '<div class=\\\"chatCellHeader\\\">'+data.nick+' пишет:</div>'+\\r\\n                '<div class=\\\"chatCellBody\\\">'+data.msg+\\r\\n                '</div></div>';\\r\\n                if (soundToggle) {\\r\\n                    msg_in.play();\\r\\n                }\\r\\n                else;\\r\\n        }\\r\\n       \\r\\n        $('#chatBody').append(msg);\\r\\n        autoscrolling();        \\r\\n    });\\r\\n    \\r\\n    function sendMsg(data){\\r\\n        var msg = $('#msgBox').val();\\r\\n        $('#msgBox').val('');\\r\\n        socket.emit('msg', msg);\\r\\n    }\\r\\n    \\r\\n    \\r\\n    socket.on('cl', function(data){\\r\\n        $('#contactListBody').empty();\\r\\n        for(var i in data.members){\\r\\n            var contact = '<div class=\\\"contactUnit\\\">'+data.members[i]+'</div>';\\r\\n            $('#contactListBody').append(contact);\\r\\n        }\\r\\n        if (data.msg) {\\r\\n            var msg = '<div class=\\\"chatCellSys\\\">'+\\r\\n            '<div class=\\\"chatCellHeader\\\">Системное сообщение</div>'+\\r\\n            '<div class=\\\"chatCellBodySys\\\">'+data.msg+\\r\\n            '</div></div>';\\r\\n            $('#chatBody').append(msg);\\r\\n            autoscrolling(); \\r\\n        }\\r\\n        \\r\\n        \\r\\n    });\\r\\n    \\r\\n    socket.on('disconnect', function(){\\r\\n        $('#chat').fadeOut(1000);\\r\\n        $('#contactList').fadeOut(1000);\\r\\n        $('#globalFooter').fadeOut(1000);\\r\\n        \\r\\n        $('#status').text('Отключено').css({\\r\\n            'text-shadow':'0 0 5px #F00',\\r\\n            'color':'#F00'\\r\\n        });\\r\\n    });\\r\\n    \\r\\n    function nickNameSend(){\\r\\n        socket.emit('nickname', nickname);        \\r\\n    }\\r\\n    function nickNameSubmit(){\\r\\n        $('#nickName').val('');\\r\\n        $('#globalFooter').fadeIn(1000);\\r\\n        $('#nickNameSubmit').fadeOut(1000);\\r\\n        $('#nickName').fadeOut(1000);\\r\\n        $('#chatHeaderText').text('Вы вошли как '+nickname);\\r\\n        $('#exitSubmit').fadeIn(1000);\\r\\n        $('#msgBox').focus();\\r\\n        nickNameSend();\\r\\n        \\r\\n    }\\r\\n    \\r\\n    \\r\\n    //Client side logic\\r\\n    \\r\\n    $('#nickNameSubmit').click(function(){\\r\\n        if($('#nickName').val()){\\r\\n            nickname = $('#nickName').val();\\r\\n            nickNameSubmit();\\r\\n        }\\r\\n        else;\\r\\n    });\\r\\n    $('#nickName').keypress(function(e){\\r\\n        if(e.which == 13){\\r\\n            nickname = $('#nickName').val();\\r\\n            nickNameSubmit();\\r\\n        }\\r\\n        else;\\r\\n    });\\r\\n    $('#nickName').focus(function(){\\r\\n        $(this).val('');\\r\\n    });\\r\\n        \\r\\n    \\r\\n    \\r\\n    $('#msgSend').click(function(){\\r\\n        if($('#msgBox').val()){\\r\\n           sendMsg();\\r\\n        }\\r\\n        else;\\r\\n    });\\r\\n    $('#msgBox').keypress(function(e) {\\r\\n        if(e.which == 13){\\r\\n            if($('#msgBox').val()){\\r\\n                sendMsg();\\r\\n            }\\r\\n            else;\\r\\n        }\\r\\n        else;\\r\\n    });\\r\\n    $('#exitSubmit').click(function() {\\r\\n        exitSubmit();\\r\\n    });\\r\\n    $('#autoscroll').click(function() {\\r\\n        $(this).toggleClass('autoscrollOn');\\r\\n        autoscroll=!autoscroll;\\r\\n    });\\r\\n    $('#soundToggle').click(function() {\\r\\n        $(this).toggleClass('autoscrollOn');\\r\\n        soundToggle=!soundToggle;\\r\\n    });\\r\\n    function exitSubmit(){\\r\\n        socket.emit('exit');\\r\\n        $('#chatHeaderText').text('Введите свой ник:');\\r\\n        $('#nickNameSubmit').fadeIn(1000);\\r\\n        $('#nickName').fadeIn(1000);\\r\\n        $('#exitSubmit').fadeOut(1000);\\r\\n        $('#nickName').val('');\\r\\n    }\\r\\n    function autoscrolling(){\\r\\n        if(autoscroll){\\r\\n            var scroll = $('#chatBody')[0].scrollHeight;\\r\\n            $('#chatBody').animate({'scrollTop':scroll},1000);\\r\\n        }\\r\\n        else;\\r\\n    }\\r\\n    \\r\\n});\"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":5653}]],\"length\":5653}\n{\"contributors\":[],\"silentsave\":false,\"ts\":1374121426073,\"patch\":[[{\"diffs\":[[0,\"  \\r\\n\"],[-1,\"    socket.on('id', function(data){\\r\\n        var id = data.substring(0,10);\\r\\n        socket.emit('guestid',id);\\r\\n    });\\r\\n    \\r\\n\"],[0,\"    \"]],\"start1\":558,\"start2\":558,\"length1\":136,\"length2\":8}]],\"length\":5525,\"saved\":false}\n{\"contributors\":[],\"silentsave\":false,\"ts\":1374144437615,\"patch\":[[{\"diffs\":[[0,\"y.c9.io'\"],[1,\",{\\r\\n        'connect timeout': 20000,\\r\\n        'reconnect': true,\\r\\n        'reconnection limit': 20000\\r\\n    }\"],[0,\");\\r\\n\"],[-1,\"\"],[0,\"    var \"]],\"start1\":303,\"start2\":303,\"length1\":20,\"length2\":129},{\"diffs\":[[0,\"le = true;\\r\\n\"],[1,\"    var timer_reconnect;\\r\\n\"],[0,\"    \\r\\n    $(\"]],\"start1\":653,\"start2\":653,\"length1\":24,\"length2\":50},{\"diffs\":[[0,\"'connect\"],[-1,\"ed\"],[0,\"', funct\"]],\"start1\":843,\"start2\":843,\"length1\":18,\"length2\":16},{\"diffs\":[[0,\"nect', function(\"],[-1,\"data\"],[0,\"){\\r\\n        $('#\"]],\"start1\":847,\"start2\":847,\"length1\":36,\"length2\":32},{\"diffs\":[[0,\"      });   \"],[1,\"\\r\\n\"],[0,\"     \"],[1,\"   if(timer_reconnect){\\r\\n        clearTimeout(timer_reconnect);\\r\\n        }\\r\\n        else;\\r\\n    });\\r\\n    \\r\\n    socket.on('connecting', function(){        \\r\\n        $('#status').text('Подключение').css({\\r\\n            'text-shadow':'0 0 5px #0FF',\\r\\n            'color':'#0FF'\\r\\n        });\\r\\n    });\\r\\n    \\r\\n    socket.on('reconnecting', function(){        \\r\\n        $('#status').text('Переподключение').css({\\r\\n            'text-shadow':'0 0 5px #0FF',\\r\\n            'color':'#0FF'\\r\\n        });        \\r\\n    });\\r\\n    \\r\\n    socket.on('error', function(reason){        \\r\\n        $('#status').text('Ошибка сервера').css({\\r\\n            'text-shadow':'0 0 5px #F00',\\r\\n            'color':'#F00'\\r\\n        });\\r\\n        timer_reconnect = setTimeout(function() {\\r\\n            alert('Boom recon');\\r\\n        }, 20000);\"],[0,\"\\r\\n    });\\r\\n \"]],\"start1\":1196,\"start2\":1196,\"length1\":29,\"length2\":831}]],\"length\":6456,\"saved\":false}\n{\"ts\":1374145223851,\"patch\":[[{\"diffs\":[[0,\"   });        \\r\\n\"],[1,\"        timer_reconnect = setTimeout(function() {\\r\\n            alert('Boom reconnect');\\r\\n        }, 5000);\\r\\n\"],[0,\"    });\\r\\n    \\r\\n \"]],\"start1\":1732,\"start2\":1732,\"length1\":32,\"length2\":140},{\"diffs\":[[0,\"t('Boom \"],[-1,\"recon\"],[1,\"error\"],[0,\"');\\r\\n   \"]],\"start1\":2123,\"start2\":2123,\"length1\":21,\"length2\":21},{\"diffs\":[[0,\" }, \"],[-1,\"2\"],[1,\"6\"],[0,\"0000\"]],\"start1\":2148,\"start2\":2148,\"length1\":9,\"length2\":9}]],\"length\":6600,\"saved\":false}\n"]],"start1":0,"start2":0,"length1":0,"length2":8790}]],"length":8790}
